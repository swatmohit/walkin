function toggleAdvanceTime(a){var b=($("#showAdvTime a"),$('input[name="scheduleType"]:checked').val());"open"==a?($("#advTime").slideDown("fast","swing"),$("#showAdvTime").html('<a href="javascript:void(0)"> Hide Advanced Time Settings </a>')):"close"==a&&($("#advTime").slideUp("fast","swing"),1==b?$("#showAdvTime").html('<span>All interviews scheduled at same time.</span><a class="noAdvance" href="javascript:void(0)"> Advanced Scheduling Settings </a>'):$("#showAdvTime").html('<a href="javascript:void(0)"> Advanced Scheduling Settings </a>'))}function enableDisableBulkInterviewAllChkd(a){1==parseInt(isEnterprise)&&($("#emailDD .tagit").length==Object.keys(a.id.emailDD[0]).length?$("#emailDD .optgroup").find("a").addClass("chkd"):$("#emailDD .optgroup").find("a").removeClass("chkd"))}function disableEmailDD(a){1!=parseInt(isEnterprise)||Object.keys(a).length||$("#emailDD").find("input").attr("disabled","disabled")}function initDDs(a){for(key in a){var b={},c={};c[key+"DD"]=[arrObj[key][0],arrObj[key][1]],b.id=c,b.maxHeight=100,b.placeHolderText="Select or Start Typing","startTime"==key&&(b.onClickReq=function(){makeDD("endTime"),makeDD("breakTime"),interviewNum()}),"statusList"==key&&(b.maxHeight=300,b.onClickReq=function(a,b){
// from applyInbox.js. There is hard dependency of applyInbox.js and bulkInterview.js
handleAssessmentOnStatusChange();var c=$("#hid_statusListDD").val();$.inArray(c,interviewArr)!==-1?(toggleScheduleForm("show"),interviewNum()):(toggleScheduleForm("hide"),scheduleCount=0,hideErrMsg())}),"interviewDuration"!=key&&"breakDuration"!=key||(b.onClickReq=function(){makeDD("breakTime"),interviewNum()},b.sortPrefix=sortPref),"breakTime"==key&&(b.onClickReq=function(){interviewNum()}),"endTime"==key&&(b.onClickReq=function(){var a=$("#hid_startTimeDD").val(),b=$("#hid_endTimeDD").val();fillBreakTimeDD(a,b),interviewNum()}),instance=new DD(b)}}function initializeBulkScheduling(){var a=$("#bulkStatusUpdateLtBox");initDDs(arrObj);var b=new Date;$("#dateOfInterview .input-group.date").datepicker({format:"yyyy/mm/dd",startDate:b,autoclose:!0}),$("#dateOfInterview .input-group.date").datepicker("update",b),contactListObj={id:{emailDD:[interviewEmailList]},maxHeight:300,checkBox:!0,placeholder:"Select Contact",noDataTxt:"Not Present in Contact List. Type Email Id and press 'Enter Key' to Add the List",onClickReq:function(a,b){bulkInterviewSelectedItemList(),enableDisableBulkInterviewAllChkd(a)},allChk:!0},1!=parseInt(isEnterprise)?(emailDD=new DD(contactListObj),attachEventForBulkTag("emailDD")):(emailDD=new customDD(contactListObj),disableEmailDD(interviewEmailList)),a.off("click","#showAdvTime a").on("click","#showAdvTime a",function(){toggleAdvanceTime(0==$("#advTime").is(":visible")?"open":"close"),interviewNum()}),a.off("change",'input[name="scheduleType"]').on("change",'input[name="scheduleType"]',function(){$("#interviewDuration").slideToggle("fast","swing","this.checked"),interviewNum(),"2"==$("input[name=scheduleType]:checked").val()?("undefined"==typeof _bulkInstance||0===$("#bulkDetail").length?showSchedule():$("#advTime").next().show(),initializeInfo()):hideSchedule()}),a.off("click","#breakTimeChk").on("click","#breakTimeChk",function(){$("#breakTime").slideToggle("fast","swing","this.checked"),interviewNum()}),a.off("click","#isRejected").on("click","#isRejected",function(){if(1==$("#isRejected").is(":checked"))hideErrMsg(),$("#inp_statusListDD_err").removeClass("msg_errf"),$("#inp_statusListDD").removeClass("msg_errf"),toggleScheduleForm("hide"),disableDD("statusListDD"),removeAssessmentDetailsFromStatusChangeBox(),$("#bulkStatusUpdateLtBox #bulkStatusUpdateBtn").text("Update");else{enableDD("statusListDD");var a=$("#hid_statusListDD").val();$.inArray(a,interviewArr)!==-1&&toggleScheduleForm("show"),interviewNum(),handleAssessmentOnStatusChange()}scheduleCount=0}),frmValidate.validate({formNames:["bulkStatus"],errors:commonErrList,styles:{errorClass:"msg_errf",okClass:"ok",softMandClass:"softMand",parentObjectClass:"DDsearch",maxLevel:2},clearOnFocus:!0,inlineErrors:!0,focusOnError:!1,defaultEvents:["blur"],submitButton:["bulkStatusUpdateBtn"]});var c=giveMeIds("interViewSchedule");frmValidate.hideElement(c),fillEndTimeDD(dfltStart,dfltEnd),fillBreakTimeDD(dfltStart,dfltEnd,dfltBreak)}function objToArr(a){var b=0,c=[],d=[];for(key in a)c[b]=a[key],d[b]=key,b++;return[d,c]}function calEndTime(a){for(var b=objToArr(arrObj.startTime[0]),c=b[0],d=c.indexOf(a),e={},f=d;f<c.length;f++)e[c[f]]=arrObj.startTime[0][c[f]];return e}function calBreakTime(a,b){for(var c=objToArr(arrObj.startTime[0]),d=c[0],e=b||d[d.length-1],f=d.indexOf(a),g={},h=f;h<e;h++)g[d[h]]=arrObj.startTime[0][d[h]];return g}function fillEndTimeDD(a,b){var c=calEndTime(a),d={id:{endTimeDD:[c,b]}};d.onClickReq=function(){makeDD("breakTime"),interviewNum()},d.maxHeight=100,endTimeDDinstance!={}&&endTimeDDinstance.destroyDD,currState.endTime[0]=c,endTimeDDinstance=new DD(d)}function fillBreakTimeDD(a,b,c){var d=$("#inp_interviewDurationDD").val().split(" ");"mins"==d[1]||"min"==d[1]?a=parseInt(a)+parseInt(d[0])/15:"hrs"!=d[1]&&"hr"!=d[1]||(d[0]=60*parseFloat(d),a=parseInt(a)+parseInt(d[0])/15),a=String(a);var e=calBreakTime(a,b),f={id:{breakTimeDD:[e,c]}};f.onClickReq=function(){interviewNum()},f.maxHeight=100,breakTimeDDinstance!={}&&breakTimeDDinstance.destroyDD,currState.breakTime[0]=e,breakTimeDDinstance=new DD(f)}function makeDD(a){var b=$("#hid_startTimeDD").val(),c=$("#hid_endTimeDD").val(),d=$("#hid_breakTimeDD").val();"endTime"==a?fillEndTimeDD(b,c):"breakTime"==a&&fillBreakTimeDD(b,c,d)}function disableDD(a){$("#inp_"+a).attr("disabled",!0)}function enableDD(a){$("#inp_"+a).removeAttr("disabled")}function giveMeIds(a){for(var b=$("#"+a+" input"),c=[],d=b.length,e=0;e<d;e++)c[e]=$(b[e]).attr("id");return c}function bulkInterviewSelectedItemList(){var a=$("#emailDD .dCross").length;"undefined"!=typeof isEnterprise&&parseInt(isEnterprise)&&(a<=0?$("#emailDD").append('<div id="bulkInterviewerEmailListError" class="mt5" style="color:#c09853">No interviewers selected for this candidate</div>'):a>50?($("#bulkInterviewerEmailListError").length<=0&&$("#emailDD").append('<div id="bulkInterviewerEmailListError" class="mt5" style="color:#c09853">Maximum 50 interviewers can be selected</div>'),$("#inp_emailDD").attr("disabled","disabled"),$("#dp_emailDD").css("display","none"),$("#bulkStatusUpdateBtn").removeClass("disbl gray_btn").removeClass("red_btn").addClass("disbl gray_btn")):($("#bulkInterviewerEmailListError").length>0&&$("#bulkInterviewerEmailListError").remove(),$("#inp_emailDD").removeAttr("disabled"),$("#dp_emailDD").css("display","block"),$("#bulkStatusUpdateBtn").removeClass("disbl gray_btn").addClass("red_btn")))}function toggleScheduleForm(a){var b=giveMeIds("interViewSchedule");if("show"===a){var c=$("#hid_statusListDD").val();$("#hid_statusListDD").val();var d=c.split("_");const e={projectId:Number(trim(projectIdOnPage[0])),statusId:Number(d[0]),subStatusId:Number(d[1])};1==parseInt(isEnterprise)&&$.ajax({url:"/profile/getRecruitersForInterviewStage",dataType:"json",type:"post",contentType:"application/json",data:JSON.stringify(e),success:function(a){contactListObj={id:{emailDD:[a]},maxHeight:300,checkBox:!0,placeholder:"Select Contact",noDataTxt:"Not Present in Contact List.",onClickReq:function(a,b){bulkInterviewSelectedItemList(),enableDisableBulkInterviewAllChkd(a)},allChk:!(Object.keys(a).length>50)},1!=parseInt(isEnterprise)?emailDD=new DD(contactListObj):($("#hid_emailDD").length&&$("#hid_emailDD").remove(),$("#emailDD .tagit").remove(),$("#dp_emailDD").remove(),emailDD=new customDD(contactListObj),disableEmailDD(a))},error:function(a){}}),$("#interViewSchedule").slideDown("fast","swing"),frmValidate.showElement(b)}else"hide"===a&&($("#interViewSchedule").slideUp("fast","swing"),frmValidate.hideElement(b))}function interviewNum(){var a,b,c,d,e=$('input[name="scheduleType"]:checked').val(),f=$("#hid_startTimeDD").val(),g=$("#hid_endTimeDD").val(),h=$("#inp_breakDurationDD").val(),i=$("#hid_breakTimeDD").val(),j=$("#inp_interviewDurationDD").val(),k=j.split(" ")[1],l=j.split(" ")[0],m=$("#inp_breakDurationDD").val().split(" ");1==isBulkEdit?(d=editAppIds,c=editAppIds.length):(d=selectedAppIds,c=selectedAppIds.length),b=parseInt(g-f)/4*60,2==e?(a="min"==k||"mins"==k?parseFloat(l):60*parseFloat(l),$("#breakTimeChk").is(":checked")?b-="min"==m[1]||"mins"==m[1]?parseFloat(m[0]):60*parseFloat(m[0]):(i=0,h=""),b<0&&(b=0),scheduleCount=Math.floor(b/a),c<scheduleCount&&(scheduleCount=c)):(j="",scheduleCount=c),c<scheduleCount&&(scheduleCount=c),c>scheduleCount&&0!=scheduleCount?($("#scheduledCount").html(scheduleCount),$("#totalApplyCount").html(" / "+c),$("#scheduleWarning").slideDown("fast","swing")):$("#scheduleWarning").slideUp("fast","swing"),showScheduleInfo(d,f,g,j,i,h,scheduleCount),0==scheduleCount?showErrMsg():hideErrMsg()}function showErrMsg(){$("#bulkErrMsg").removeClass("dspN"),$("#bulkStatusUpdateBtn").removeClass("disbl gray_btn").removeClass("red_btn").addClass("disbl gray_btn")}function hideErrMsg(){$("#bulkErrMsg").removeClass("dspN").addClass("dspN"),$("#bulkStatusUpdateBtn").removeClass("disbl gray_btn").addClass("red_btn")}function attachEventForBulkTag(a){$n("#"+a+" input").addEvent("keyup",function(b){if(13==b.keyCode||188==b.keyCode)if(""!=$n(this).val().trim()&&","!=$n(this).val().trim()){if("noData"==$n("#ul_"+a).childrens().attr("class")){tgCount++;var c=a+"_new"+tgCount;if(188==b.keyCode)var d=$n(this).val(),e=d.split(","),f=e[0];else var f=$n(this).val();interviewEmailList["new"+tgCount]=f,
//$n('#newContactObj').val(JSON.stringify(newContacts));
$n(this).val(""),emailDD.CreateTags(f,c,a,!1,!1),addCloseEvent(c,tgCount,"emailDD"),$n("#dp_emailDD").currObj().style.display="none",emailDD.focusEv.call($n("#inp_emailDD").currObj(),b)}}else $n(this).val("")})}function endBreakTime(){var a,b,c=$("#hid_breakTimeDD").val(),d=15,e=$("#inp_breakDurationDD").val().split(" "),f=$("#hid_endTimeDD").val();return a="min"===e[1]||"mins"===e[1]?parseInt(e[0])/d:60*parseFloat(e[0])/d,b=parseInt(c)+parseInt(a),b>f?1:0}function storeBulkdata(){for(key in arrObj)currState[key]=arrObj[key]}function updateStore(){for(key in arrObj)currState[key][1]=$("#hid_"+key+"DD").val();stateVar.date=$("#interviewDate").val(),stateVar.venue=$("#venue").val(),stateVar.scheduleType=$('input[name="scheduleType"]:checked').val(),stateVar.isBreak=$("#breakTimeChk").is(":checked"),stateVar.isRejected=$("#isRejected").is(":checked"),stateVar.isAdvance="block"==$("#advTime").css("display"),stateVar.emailDD=$("#hid_emailDD").val(),stateVar.remarks=$("#remakrs").val()}function initBulkLBforEdit(){initDDs(currState),$("#dateOfInterview .input-group.date").datepicker("update",stateVar.date),$("#venue").val(stateVar.venue),$("#remakrs").val(stateVar.remarks),$('input[name="scheduleType"][value='+stateVar.scheduleType+"]").click(),toggleAdvanceTime(stateVar.isAdvance?"open":"close"),stateVar.isBreak!=$("#breakTimeChk").is(":checked")&&$("#breakTimeChk").click(),""!=stateVar.emailDD||stateVar.emailDD!=[]?contactListObj={id:{emailDD:[interviewEmailList,JSON.parse(stateVar.emailDD)]},maxHeight:300,checkBox:!0,placeholder:"Select Contact",noDataTxt:"Not Present in Contact List. Type Email Id and press 'Enter Key' to Add the List",onClickReq:function(a,b){},allChk:!0}:contactListObj={id:{emailDD:[interviewEmailList,""]},maxHeight:300,checkBox:!0,placeHolderText:"Select Contact",noDataTxt:"Not Present in Contact List. Type Email Id and press 'Enter Key' to Add the List",onClickReq:function(a,b){enableDisableBulkInterviewAllChkd(a)},allChk:!0},1!=parseInt(isEnterprise)?(emailDD=new DD(contactListObj),attachEventForBulkTag("emailDD")):(emailDD=new customDD(contactListObj),disableEmailDD(interviewEmailList)),$("#isRejected").is(":checked")!=stateVar.isRejected&&$("#isRejected").click(),$(".bulkProfileCount").html(scheduleCount)}function showSchedule(){var a={list:bulkDetailInfo,order:["left","right","bottom","top"],dir:"right",tipWidth:5,tipHeight:5,wrapper:"body","class":"bulkInfo",open:{event:"click"},close:{event:"none"}};$("#advTime").after(' <div class="row oh pt10 sdlInfo"><span class="text888">Interview(s) scheduled one after another. </span><a href="javascript:void(0)" class="tipbulkDetail" id="bulkDetail" tooltip="bulkSchedule">Show Interview Schedule</a></div>'),_bulkInstance=$("#bulkDetail").tooltipNew(a),$(document).off("click",".close-tooltip").on("click",".close-tooltip",function(){_bulkInstance.close()}),$(document).on("click","#bulkDetail",function(){initializeInfo()}),$(document).on("click",function(a){var b=document.getElementById("bulkDetail");"undefined"!=typeof _bulkInstance&&b!=a.target&&_bulkInstance.close()}),$(".tooltipBox.bulkInfo").on("click",function(a){var b=document.getElementsByClassName("close-tooltip")[0];a.target!=b&&event.stopPropagation()})}function hideSchedule(){$("#advTime").next().hide()}function findCandidateName(a){var b=[];/*for (var o in candNamesJson) {
        $.extend(nameObj,candNamesJson[o])
    }*/
for(i=0;i<a.length;i++)b[i]=""!=candNamesJson[a[i]]?candNamesJson[a[i]]:"Not Mentioned";
//console.log(nameArr);
return b}function showScheduleInfo(a,b,c,d,e,f,g){var h=findCandidateName(a);tableData="";var j,k,l=d.split(" "),m=f.split(" "),n=parseInt(e),o=parseInt(b),p=1;if(k="min"==l[1]||"mins"==l[1]?parseFloat(l[0])/15:4*parseFloat(l[0]),""!=f&&("min"==m[1]||"mins"==m[1]?_brkhop=parseFloat(m[0])/15:_brkhop=4*parseFloat(m[0])),""!=d)if(""!=f)for(p=1,i=0;i<g;i++)intrvStrt=o,intrvEnd=o+k,intrvStrt==n||n>intrvStrt&&n<intrvEnd?(breakTime=arrObj.breakTime[0][e],tableData+='<tr class="disable"> <td class="col1"> <span>'+breakTime+'</span> </td><td class="col2"> <span>'+f+" Break </span> </td></tr>",o=n+_brkhop,i--):(j=arrObj.startTime[0][intrvStrt],tableData+='<tr> <td class="col1"> <span>'+j+'</span> </td><td class="col2"> <span>'+h[i]+"</span> </td></tr>",o+=k);else for(i=0;i<g;i++)intrvStrt=o,o+=k,j=arrObj.startTime[0][intrvStrt],tableData+='<tr> <td class="col1"> <span>'+j+'</span> </td><td class="col2"> <span>'+h[i]+"</span> </td></tr>";
//console.log(tableData);
"undefined"!=typeof _bulkInstance&&initializeInfo()}function initializeInfo(){_bulkInstance.options.list.bulkSchedule='<div class="bulkHeading"><span class="bulkInfoHead dIb fl"> Interview Schedule</span><a href="javascript: void(0);" class="close-tooltip"></a></div><table class="headTable"><tr class="tableHead"><td class="col1"> <b>Interview Time</b></td><td class="col2"> <b>Candidate Name</b></td></tr></table><div class="bulkPane"><div class="scrollContent"><table class="bulkTable">'+tableData+" </table></div></div>"}var arrObj=currState={startTime:[{},[]],endTime:[{},[]],statusList:[{},[]],subStatus:[{},[]],interviewType:[{},[]],interviewDuration:[{},[]],breakDuration:[{},[]],breakTime:[{},[]]},stateVar={};commonErrList[6002]=function(a){var b=!1;return""==a.val()?($($("#pCW1").parent()).removeClass("msg_errF").addClass("msg_errF"),b="Select a valid date."):$($("#pCW1").parent()).removeClass("msg_errF"),{msg:b,id:"interviewDate_err"}},
//Validations for advance time
commonErrList[6004]=function(a){var b=!1,c=a.next().val(),d=$('input[name="scheduleType"]:checked').val();return""==c&&2==d?(a.parent().parent().removeClass("msg_errf").addClass("msg_errf"),b="Required field can not be left blank.",toggleAdvanceTime("open")):a.parent().parent().removeClass("msg_errf"),errField=a.attr("id")+"_err",{msg:b,id:errField}},
//Validator for Break Time
commonErrList[6005]=function(a){var b=!1,c=a.next().val(),d=$("#breakTimeChk").is(":checked"),e=$('input[name="scheduleType"]:checked').val();return""==c&&d&&2==e?(a.parent().parent().removeClass("msg_errf").addClass("msg_errf"),b="Required field cannot be blank.",toggleAdvanceTime("open")):a.parent().parent().removeClass("msg_errf"),errField=a.attr("id")+"_err",{msg:b,id:errField}},
//Validation for break Time after endtime
commonErrList[6006]=function(a){var b=!1,c=$("#inp_breakTimeDD"),d=$("#inp_breakDurationDD"),e=endBreakTime();return 1==e?(c.parent().parent().removeClass("msg_errf").addClass("msg_errf"),b="Your Break Time exceeds the selected End Time for Interviews. Please select an appropriate Break Time"):(c.parent().parent().removeClass("msg_errf"),d.parent().parent().removeClass("msg_errf")),{msg:b,id:"inp_breakTimeDD_err"}};var interviewArr=[],interviewEmailList={},scheduleCount=-1,sortPref="a_",frmValidate=newCommonValidator(),dfltStart="38",dfltEnd="70",dfltBreak=parseInt((parseInt(dfltStart)+parseInt(dfltEnd))/2).toString();$.fn.toggleHTML=function(a,b){return this.html(function(c,d){return $.trim(d)===a?b:a})};var endTimeDDinstance={},breakTimeDDinstance={},tgCount=0,newContacts={},bulkDetailInfo={bulkSchedule:'<div class="bulkHeading"><span class="bulkInfoHead dIb fl"> Interview Schedule</span><a href="javascript: void(0);" class="close-tooltip"></a></div><table class="headTable"><tr class="tableHead"><td class="col1"> <b>Interview Time</b></td><td class="col2"> <b>Candidate Name</b></td></tr></table><div class="bulkPane"><div class="scrollContent"><table class="bulkTable"><tr><td class="col1"> <span>9:30 am</span></td><td class="col2"> <span>Rahul Sharma</span></td></tr><tr><td class="col1"> <span>9:30 am</span></td><td class="col2"> <span>Rahul Sharma</span></td></tr><tr><td class="col1"> <span>9:30 am</span></td><td class="col2"> <span>Rahul Sharma</span></td></tr><tr><td class="col1"> <span>9:30 am</span></td><td class="col2"> <span>Rahul Sharma</span></td></tr><tr><td class="col1"> <span>9:30 am</span></td><td class="col2"> <span>Rahul Sharma</span></td></tr></table></div></div>'},_bulkInstance,tableData="";