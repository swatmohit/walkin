/*
 *Author: [Nitin] 
 * Version: [v1.4]
 * Updated By: [Nitin]
 * Description: (Changed from v1.3 to v1.4, design changes)
 */
var originalEvent,initRound=function(a){if(!a||"object"!=typeof a)return!1;// handling arguments
if(!(this instanceof initRound))return new initRound(a);
// Scope Safe constructor
var b=this;b.objid=a.ids,b.objson=a.jdata||{},b.activeValue=a.prefill,b.callBac=a.callFunc,b.p_reject=null,b.p_rId=void 0;var c=function(a){for(mytarget=a.target||a.srcElement,myElm=mytarget;"LI"!==myElm.parentElement.nodeName;)myElm=myElm.parentElement;$n(objid).childrens(".disable").length&&$n(objid).childrens(".disable").removeClass("disable");var c=myElm.parentElement;if(null!=c.getAttribute("class")&&"active"==c.getAttribute("class").trim())return!1;var d={obj:$n(mytarget)},f=e.returnelm.call(d),g=f.attr("stageKey");return!(!window.isAllowedToChangeToOffer&&"true"===f.attr("offerGenerationEnabled"))&&($n("#interviewrap").hide(),void b.selectedValue(g,!0))},d=function(a){b.activeValue=$n(a).parent().childrens(".interTxt").attr("data-id"),b.rejectcall()};
//    This removes handler for all confirmation containers
$(document).off("click","#confirmationContainer .confBtn.yes"),$(document).on("click","#confirmationContainer .confBtn.yes",function(a){if(a.stopPropagation(),
//Hide the LBs first
$("#confirmationContainer").addClass("dspNImp"),$(originalEvent.target).hasClass("rjbtn"))return d(originalEvent.target),!1;if($(originalEvent.target).parents("li").hasClass("isOfferStage")){var b="undefined"!=typeof candidateApplicationId&&candidateApplicationId||$("[id^='applicationId']",$(objid).closest(".srchTup")).val(),e=$(originalEvent.target).closest("li").attr("stageKey").split("_"),f=e[0],g=e[1];window.renderOfferLayer(0,b,f,g)}else c(originalEvent)}),$(document).off("click","#statusChangeConfirmationContainer .confBtn.yes"),$(document).on("click","#statusChangeConfirmationContainer .confBtn.yes",function(a){if(a.stopPropagation(),
//Hide the LBs first
$("#statusChangeConfirmationContainer").addClass("dspNImp"),$(objid).removeAttr("data-offerapproval"),$("#approvalPendingConfirmation").remove(),$(originalEvent.target).removeAttr("data-offerapproval"),$(originalEvent.target).hasClass("rjbtn"))return d(originalEvent.target),!1;if($(originalEvent.target).parents("li").hasClass("isOfferStage")){var b="undefined"!=typeof candidateApplicationId&&candidateApplicationId||$("[id^='applicationId']",$(objid).closest(".srchTup")).val(),e=$(originalEvent.target).closest("li").attr("stageKey").split("_"),f=e[0],g=e[1];window.renderOfferLayer(0,b,f,g)}else c(originalEvent)}),$(document).on("click","#statusChangeConfirmationContainer .confBtn.no, #statusChangeConfirmationContainer .confCancel",function(){$("#statusChangeConfirmationContainer").addClass("dspNImp")}),$(document).on("click","#confirmationContainer .confBtn.no, #confirmationContainer .confCancel",function(){$("#confirmationContainer").addClass("dspNImp")}),b.commonlist=function(a,b,c,d){var e,f,g,h=a,i=b,j=c,k=d;if(j.hideit)return"";var l={color:j.color,stageKey:i};return j.isOfferStage&&parseInt(j.isOfferStage)&&(l["class"]="isOfferStage"),!window.isAllowedToChangeToOffer&&j.offerGenerationEnabled&&parseInt(j.offerGenerationEnabled)&&(l.style="background: #f0efef;",l.offerGenerationEnabled=!!j.offerGenerationEnabled,l.title="You do not have permissions to change status of this candidate."),e=$n("<li>").attr(l),f=$n("<a>").append(h).attr({href:"javascript:void(0)"}),k&&(e.attr({stageKey:i+"_"+k}),g=$n("<span>").append(" - "+j.text),f.append(g)),e.append(f),e},b.addEventForAll=function(){$n(".interview").addEvent("click",function(a){objid="#"+this.getAttribute("id"),
// console.log(this.getAttribute('id').substring(13)
a=a||window.event;var b=a.target||a.srcElement;if("outerArow"==b.className.trim()||"s_downArrow"==b.className.trim()){a.stopPropagation?a.stopPropagation():a.cancelBubble=!0;var c=$n(b),d=c,e=8,f=c.position(),g=c.height(),h=c.parent().childrens(".interTxt").attr("data-id");$n("#interviewrap .intround").childrens(".active").removeClass("active"),$n("#interviewrap .intround").childrens('li[stagekey="'+h+'"]').addClass("active"),$n("#interviewrap").css({left:f.left-c.offLeft()+"px",top:f.top+g+10+"px"});var i=d.offLeft()+(d.width()/2-e);$n("#interviewrap #intiparrow").css({left:i+"px",position:"absolute",zIndex:"10001",top:"-7px"}),$n("#interviewrap").show()}})},/**
         * [appendobj - Add event on Drop arrow for all status nav]
         */
b.appendobj=function(){
//t.outerObject = private.objstr();
//
// var myanc = $n(t.objid).childrens('a .outerArow')
b.addulList()},b.rejectcall=function(){
//var objid = this.parentElement.getAttribute('id');
b.callBac({objId:b.objid,activeKey:b.activeValue,rejected:!0})};var e={objisEmpty:function(a){for(var b in a)if(a.hasOwnProperty(b))return!0;return!1},subList:function(a,c,d,e,f){if(f)for(var g in d)e.append(b.commonlist(a,c,d[g],d[g].subStatusId));else e.append(b.commonlist(a,c,d));return e},domList:function(a){var b,c,d=a,f="";if(e.objisEmpty(d)){f=$n("<ul>").addClass("statusNav intround").css({display:"block"}),e.addObjEvent(f);for(b in d)c=d[b].text,f=d[b].hasSubStatus?e.subList(c,d[b].statusId,d[b].subStatusList,f,!0):e.subList(c,d[b].statusId,d[b],f)}return f},objstr:function(){var a=$n("<a>").attr({href:"javascript:void(0)"}),b=$n("<span>").addClass("interTxt"),c=$n("<span>").append($n("<em>").addClass("s_downArrow")).addClass("outerArow");return regbtn=$n("<a>").append("Reject").addClass("rjbtn"),a.append(b).append(c),{objwrap:a,rejectbtn:regbtn}},addObjEvent:function(a){var b=a;b.addEvent("click",function(a){if(a.stopPropagation?a.stopPropagation():a.cancelBubble=!0,!a)var a=window.event;if(originalEvent=a,"1"===$(objid).attr("data-offerapproval"))
// SRP Page
$("#statusChangeConfirmationContainer").removeClass("dspNImp");else if($("#approvalPendingConfirmation").length>0)
// CV Detail page
$("#approvalPendingConfirmation #statusChangeConfirmationContainer").removeClass("dspNImp");else if("1"===$(objid).attr("data-offer"))$("#confirmationContainer").removeClass("dspNImp");else if($(originalEvent.target).parents("li").hasClass("isOfferStage")){if(!window.isAllowedToChangeToOffer&&"true"===$(originalEvent.target).parents("li").attr("offerGenerationEnabled"))return!1;var b="undefined"!=typeof candidateApplicationId&&candidateApplicationId||$("[id^='applicationId']",$(objid).closest(".srchTup")).val(),d=$(originalEvent.target).closest("li").attr("stageKey").split("_"),e=d[0],f=d[1];window.renderOfferLayer(0,b,e,f)}else c(originalEvent)})},addReject:function(){
//  t.outerObject.rejectbtn.addEvent('click', t.rejectcall);
//  $n(t.objid).append(t.outerObject.rejectbtn);
$n(".rjbtn").addEvent("click",function(a){if(!a)var a=window.event;return originalEvent=a,b.objid="#"+this.parentElement.getAttribute("id"),!$n(this).hasClass("disable")&&void("1"===$(b.objid).attr("data-offer")?$("#confirmationContainer").removeClass("dspNImp"):d(this))})},returnelm:function(){for(;"li"!=this.obj.currObj().nodeName.toLowerCase();)this.obj=this.obj.parent();return this.obj}};!function(){b.uldom=e.domList(b.objson),b.appendobj(),b.addEventForAll(),e.addReject(),
//t.selectedValue(t.activeValue,false);
b.hideinterview()}()};initRound.prototype={/**
     * [append the list of status]
     */
addulList:function(){if(!$n("#interviewrap").length){var a=$n("<div>").addClass("interviewrap").attr({id:"interviewrap"}),b=$n("<small>").addClass("topArowIc menuDrpIcon").attr({id:"intiparrow"}),c=$n("<div>").addClass("cl").attr({id:"itm"});$n("body").append(a.append(b).append(c)),$n("#itm").append(this.uldom)}},selectedValue:function(a,b){this.activeValue;var c,d,e=this.objson;
//val.match(/^[0-9]+_+[0-9]+$/)
if(a&&(a.match(/^[0-9A-Z]+_+[0-9]+$/i)||a.match(/^[0-9A-Z]+_+[0-9]+_+[0-9]+$/i)||a.match(/^[0-9A-Z]+_+[0-9]+_+[0-9]+_+[0-9]+$/i))){this.activeValue=a;var f=a.split("_"),g=a.split("_").slice(1).join("_"),h=new Array;h[0]=f[0],h[1]=g;for(k in e)if(e[k].statusId==h[0]){h[0]=k;for(j in e[k].subStatusList)if(e[k].subStatusList[j].subStatusId==h[1]){h[1]=j;break}}if(f=e[h[0]].text,subjson=e[h[0]].subStatusList[h[1]],"undefined"!=typeof subjson){var g=subjson.text;d=subjson.color,this.rejList=this.rejlistmaker(f,h[0],subjson,h[1],a)}c=f+" - "+g}else{for(k in e)if(this.activeValue=a,e[k].statusId==a){a=k;break}c=e[a].text,d=e[a].color,this.rejList=this.rejlistmaker(c,a,e[a],"",a)}this.rejList&&this.rejectedCase(),$n(objid).childrens(".interTxt").html(c).attr({title:c}).css({backgroundColor:d}).attr({"data-id":this.activeValue}),$(objid).removeAttr("data-offer"),1===$("#offerDetails").length&&window.loadTimeLine(),
//  this.activeValue = val;
b?this.callBac({objId:objid,activeKey:this.activeValue,rejected:!1}):"",//  callback function on change stage
this.uldom.childrens("li").removeClass("active"),this.uldom.childrens('li[stagekey="'+a+'"]').addClass("active")},rejlistmaker:function(a,b,c,d,e){var f="",g=c,h=a,b=b,i=d,j=this,k=e;return g.rejected?(g.rejected=!1,f=i?this.commonlist(h,b,g,i):this.commonlist(h,b,g),g.rejected=!0,null==this.p_reject&&(this.p_reject=f,this.p_rId=k),$n(objid).childrens(".rjbtn").removeEvent("click",j.rejectcall),$n(objid).childrens(".rjbtn").addClass("disable")):this.p_reject&&(this.p_reject.remove(),this.p_reject=null),f},rejectedCase:function(){this.uldom.prepend(this.rejList)},hideinterview:function(){$n("html").addEvent("click",function(){$n("#interviewrap").hide()})}};